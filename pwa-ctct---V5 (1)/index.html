<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BAN CH·ªà HUY PTKV3 ‚Äì Trung t√¢m Gi√°o d·ª•c Ch√≠nh tr·ªã s·ªë</title>

  <!-- PWA -->
  <link rel="manifest" href="/manifest.webmanifest">

  <!-- CSS l√µi -->
  <link rel="stylesheet" href="css/style.css?v=20251006">
  <link rel="stylesheet" href="css/nav.css?v=20251006-ux2">
  <link rel="stylesheet" href="css/home.css?v=20251006-sgv5b">

  <!-- Font -->
  <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;800;900&display=swap" rel="stylesheet" />

  <style>
    :root{
      --brand-gold:#FFD966;
      --card-bg:rgba(255,255,255,.08);
      --card-stroke:rgba(32, 28, 28, 0.18);
      --blur:12px;
    }

    /* ===== N·ªÄN C·ªê ƒê·ªäNH ===== */
    .bg-layer{
      position:fixed; inset:0; z-index:-1; pointer-events:none;
      background-image:
        linear-gradient(180deg, rgba(139,22,22,.78) 0%, rgba(164,25,25,.82) 60%, rgba(185,62,30,.70) 85%, rgba(255,217,102,.30) 100%),
        var(--bg-desktop, url("/assets/bg-desktop.png"));
      background-size:cover,cover; background-position:center,center; background-repeat:no-repeat,no-repeat;
    }
    @media (max-width:768px){
      .bg-layer{
        background-image:
          linear-gradient(180deg, rgba(164,25,25,.84), rgba(139,22,22,.84)),
          var(--bg-mobile, url("/assets/bg-mobile.png"));
      }
    }

    /* ===== Typo + Layout ===== */
    body.home, body.home *:not(code):not(kbd){
      font-family:"Be Vietnam Pro",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif!important;
    }
    body{color:#fff}
    .container{max-width:1180px;margin:0 auto;padding:0 20px}

    /* ===== HERO ===== */
    .hero {position: relative; color: #fff;}
    @media (max-width: 900px){.hero__inner { grid-template-columns: 1fr; padding-top: 72px; }}

    .hero p{max-width: 820px; font-size: clamp(16px, 2.2vw, 20px); opacity: .98; margin-bottom: 28px;}
    .hero__actions{ display:flex; gap:14px; flex-wrap:wrap; }
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px; padding: 14px 26px;border-radius: 14px; font-weight: 800;font-size: 18px; cursor:pointer; user-select:none; text-decoration:none; transition: transform .08s ease, box-shadow .25s ease, background .25s ease, color .25s ease, border-color .25s ease;}
    .btn--primary{background:#FFD966; color:#7E120F; border:0; box-shadow: 0 8px 24px rgba(255,217,102,.35);}
    .btn--primary:hover{background:#FFE680; transform: translateY(-1px); box-shadow: 0 10px 28px rgba(255,217,102,.48);}
    .btn--ghost{background: transparent; color:#FFD966; border:2px solid #FFD966; box-shadow: 0 6px 20px rgba(255,217,102,.18);}
    .btn--ghost:hover{ background:#FFD966; color:#7E120F; transform: translateY(-1px); }
    .hero-badge{display:inline-flex;align-items:center;gap:8px; padding:8px 14px;border-radius:999px; font-weight:700; color:#FFD966; background:rgba(255,217,102,.14); border:1px solid rgba(255,217,102,.35); backdrop-filter: blur(2px); margin-bottom: 10px;}

    /* ===== Footer chuy√™n nghi·ªáp ===== */
    .pro-footer{margin-top: 24px; color:#f7f7f7;}
    .pro-footer .f-wave{display:block; width:100%; height:70px;}
    .pro-footer .f-panel{background: rgba(0,0,0,.16); border-top: 1px solid rgba(255,255,255,.12); backdrop-filter: blur(4px); padding: 18px 0 8px;}
    .pro-footer .f-grid{display:grid; grid-template-columns: 1.2fr 1fr 1fr; gap: 22px; align-items:flex-start; padding: 8px 0 16px;}
    @media (max-width:900px){.pro-footer .f-grid{ grid-template-columns:1fr; gap:10px; }}

    .pro-footer h4{ margin:0 0 8px; font-size:16px; color:#FFD84A; }
    .pro-footer p{ margin:6px 0; color:#f1f1f1; opacity:.95; }
    .pro-footer a{ color:#FFD84A; text-decoration:none; }
    .pro-footer a:hover{ text-decoration:underline; }
    .pro-footer .legal{ border-top:1px dashed rgba(255,255,255,.18); margin-top:8px; padding-top:10px; font-size:14px; text-align:center; color:#EDE0A0;}

    .hero-media{ display: none !important; }
    #userChip { display: none !important; } /* placeholder c≈© n·∫øu c√≥ */

        /* ===== Footer mobile polish ===== */
    @media (max-width: 900px){
      /* TƒÉng ƒë·ªám ngang container trong footer */
      .pro-footer .f-panel .container{
        padding-inline: clamp(16px, 5vw, 24px);  
        border-top: 1px solid rgba(255,255,255,.12);
        border-radius: 10px 10px 0 0;
        box-shadow: 0 -6px 24px rgba(0,0,0,.18) inset; }

      /* TƒÉng kho·∫£ng th·ªü gi·ªØa c√°c kh·ªëi */
      .pro-footer .f-grid{   gap: 16px;      }

      /* Gi·ªØ nh·ªãp d·ªçc d·ªÖ ƒë·ªçc */
      .pro-footer h4{ margin: 0 0 10px; }
      .pro-footer p { margin: 6px 0; }    }
    

  </style>

  <!-- D√≤ ƒë∆∞·ªùng d·∫´n ·∫£nh n·ªÅn (ch·∫°y ·ªü m·ªçi m√¥i tr∆∞·ªùng) -->
  <script>
    (function(){
      const bust = Date.now();
      const desk = ["/assets/bg-desktop.png","../../public/assets/bg-desktop.png","../assets/bg-desktop.png","./assets/bg-desktop.png"];
      const mob  = ["/assets/bg-mobile.png","../../public/assets/bg-mobile.png","../assets/bg-mobile.png","./assets/bg-mobile.png"];
      function pick(paths, cb){ let i=0; const step=()=>{ if(i>=paths.length) return cb(null);
        const u=paths[i++]+ "?v="+bust; const im=new Image(); im.onload=()=>cb(u); im.onerror=step; im.src=u; }; step(); }
      window.addEventListener('DOMContentLoaded',()=>{
        pick(desk,(u)=>{ if(u) document.documentElement.style.setProperty('--bg-desktop', `url("${u}")`); });
        pick(mob, (u)=>{ if(u) document.documentElement.style.setProperty('--bg-mobile',  `url("${u}")`); });
      });
    })();
  </script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      addEventListener('load', () => { navigator.serviceWorker.register('/sw.js').catch(()=>{}); });
    }
  </script>
</head>

<body class="home" data-page="home">
  <!-- N·ªÄN -->
  <div class="bg-layer" aria-hidden="true"></div>

  <!-- NAVBAR -->
  <header class="nav nav-dark">
    <div class="nav__inner container">
      <a class="brand" href="index.html">B·ªò CHQS T·ªàNH B·∫ÆC NINH</a>

      <button class="nav__toggle" aria-label="M·ªü menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>

      <nav class="nav__links">
        <a href="index.html" class="is-active">Trang ch·ªß</a>
        <a href="tintuc24.html">Tin t·ª©c</a>
        <a href="Hoctap.html">H·ªçc t·∫≠p</a>
        <a href="kiemtra.html">Ki·ªÉm tra</a>
        <div class="nav__item has-dropdown">
          <a>K·∫øt qu·∫£ ki·ªÉm tra ‚ñæ</a>
          <div class="dropdown">
            <a href="my-results.html">K·∫øt qu·∫£ c·ªßa t√¥i</a>
            <a href="leaderboard.html">B·∫£ng x·∫øp h·∫°ng</a>
          </div>
        </div>
      </nav>

      <!-- Auth actions (desktop) -->
      <div class="nav__actions hide-sm">
        <!-- USER MENU: hi·ªán sau khi ƒëƒÉng nh·∫≠p -->
        <div id="userMenu" class="user-menu" hidden>
          <div class="user-chip" id="userChipBtn">
            <div class="chip-avatar" id="chipAvatar">A</div>
            <span class="chip-name" id="chipName">Ng∆∞·ªùi d√πng</span>
          </div>
          <div class="user-dropdown" id="userDropdown" hidden>
            <button id="btnLogoutUser" class="user-item" type="button">ƒêƒÉng xu·∫•t</button>
          </div>
        </div>

        <!-- N√∫t truy·ªÅn th·ªëng (d√πng cho tr·∫°ng th√°i ch∆∞a ƒëƒÉng nh·∫≠p) -->
        <button id="btnLogin"  class="btn btn-auth btn-auth--primary" type="button">ƒêƒÉng k√Ω/ƒêƒÉng nh·∫≠p</button>
        <button id="btnLogout" class="btn btn-auth" type="button" hidden>ƒêƒÉng xu·∫•t</button>
        <span id="navProfile" class="brand" hidden></span>
      </div>
    </div>
  </header>

  <!-- MOBILE DRAWER -->
  <aside id="mDrawer" class="m-drawer" aria-hidden="true">
    <div class="m-head">
      <span class="m-home" aria-label="Trang ch·ªß" title="Trang ch·ªß">üè†</span>
      <span class="m-brand">B·ªò CHQS T·ªàNH B·∫ÆC NINH</span>
    </div>

    <nav class="m-menu" role="navigation">
      <a class="m-item" href="index.html">Trang ch·ªß</a>
      <a class="m-item" href="tintuc24.html">Tin t·ª©c</a>
      <a class="m-item" href="Hoctap.html">H·ªçc t·∫≠p</a>
      <a class="m-item" href="kiemtra.html">Ki·ªÉm tra</a>

      <button class="m-item m-drop" data-target="#m-result">K·∫øt qu·∫£ ki·ªÉm tra <span class="caret">‚ñæ</span></button>
      <div id="m-result" class="m-sub">
        <a href="my-results.html">K·∫øt qu·∫£ c·ªßa t√¥i</a>
        <a href="leaderboard.html">B·∫£ng x·∫øp h·∫°ng</a>
      </div>

      <a class="m-item" href="#" id="m-ai">Tr·ª£ l√Ω AI</a>

      <!-- Auth mobile -->
      <div class="m-auth">
        <button type="button" class="m-btn m-btn--primary" id="m-login">ƒêƒÉng k√Ω / ƒêƒÉng nh·∫≠p</button>
        <button type="button" class="m-btn m-ghost" id="m-register" hidden>ƒêƒÉng xu·∫•t</button>
      </div>
    </nav>
  </aside>

  <!-- HERO (gi·ªØ nguy√™n) -->
  <section class="hero">
    <div class="container hero__inner">
      <div>
        <div class="hero-badge">üéñÔ∏è Trung t√¢m Gi√°o d·ª•c Ch√≠nh tr·ªã s·ªë</div>
        <h1 class="soft-gold-v5">BAN CH·ªà HUY PTKV3</h1>
        <p>Kho t√†i li·ªáu ƒëa ph∆∞∆°ng ti·ªán ¬∑ Tr·ª£ l√Ω AI h·ªèi ƒë√°p t·ª©c th√¨ ¬∑ B√†i ki·ªÉm tra & ph√¢n t√≠ch k·∫øt qu·∫£ theo chu·∫©n.</p>
        <div class="hero__actions">
          <a href="Hoctap.html" class="btn btn--primary">B·∫Øt ƒë·∫ßu h·ªçc t·∫≠p</a>
          <button id="ai-toggle" type="button" class="btn btn--ghost hide-sm">Tr·ª£ l√Ω AI</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ƒê√É G·ª† HO√ÄN TO√ÄN:
       - <section class="strip"> ... KPI ...
       - <section class="features"> ... l∆∞·ªõi t√≠nh nƒÉng ...
  -->

  <!-- FOOTER CHUY√äN NGHI·ªÜP -->
  <footer class="pro-footer">
    <svg class="f-wave" viewBox="0 0 1440 70" preserveAspectRatio="none" aria-hidden="true">
      <path d="M0,40 C240,10 480,10 720,40 C960,70 1200,70 1440,40 L1440,70 L0,70 Z"
            fill="rgba(255,255,255,.14)"></path>
    </svg>

    <div class="f-panel">
      <div class="container f-grid">
        <div>
          <h4>B·ªò CHQS T·ªàNH B·∫ÆC NINH</h4>
          <p>Trung t√¢m Gi√°o d·ª•c Ch√≠nh tr·ªã s·ªë ‚Äì ¬© <span id="y">2025</span></p>
          <p>Ph√°t tri·ªÉn b·ªüi PTKV3 Digital Team</p>
        </div>
        <div>
          <h4>Li√™n k·∫øt</h4>
          <p><a href="Hoctap.html">H·ªçc t·∫≠p</a></p>
          <p><a href="exam.html">B√†i ki·ªÉm tra</a></p>
          <p><a href="leaderboard.html">B·∫£ng x·∫øp h·∫°ng</a></p>
        </div>
        <div>
          <h4>H·ªó tr·ª£</h4>
          <p><a href="practice.html">√în tr·∫Øc nghi·ªám</a></p>
          <p><a href="quiz.html">Thi th·ª≠</a></p>
          <p><a href="#" id="m-ai">Tr·ª£ l√Ω AI</a></p>
        </div>
      </div>
    </div>
  </footer>

  <!-- AI tray (gi·ªØ nguy√™n hook) -->
  <div id="ai-tray" class="ai-tray" hidden>
    <div class="ai-tray__panel">
      <header class="ai-tray__head">
        <strong>Tr·ª£ l√Ω AI</strong>
        <div class="ai-head-actions">
          <button id="ai-minify" class="ai-head-btn" title="Thu nh·ªè">‚Äì</button>
          <button id="ai-close"  class="ai-head-btn" title="ƒê√≥ng">‚úï</button>
        </div>
      </header>
      <div id="ai-messages" class="ai-tray__messages"></div>
      <div id="ai-previews" class="ai-previews" hidden></div>
      <form id="ai-form" class="ai-tray__form">
        <input id="ai-input" type="text" placeholder="Nh·∫≠p c√¢u h·ªèi‚Ä¶" autocomplete="off"/>
        <button type="submit">G·ª≠i</button>
      </form>
    </div>
  </div>
  <button id="ai-dock" class="ai-fab" hidden>Tr·ª£ l√Ω AI</button>

  <!-- JS c≈© -->
  <script src="js/config.js" defer></script>
  <script src="js/net.js" defer></script>
  <script src="js/analytics.js" defer></script>
  <script src="js/navbar.js" defer></script>
  <script src="js/news.js" defer></script>
  <script src="js/ai.js" defer></script>
  <script src="js/app.js" defer></script>

  <!-- ƒê√É G·ª† script KPI th·ª±c (tr√°nh truy c·∫≠p DOM kh√¥ng c√≤n t·ªìn t·∫°i) -->

  <!-- √âp UI Auth + User menu -->
  <script>
  (function(){
    const btnLogin   = document.getElementById('btnLogin');
    const btnLogout  = document.getElementById('btnLogout');
    const mLogin     = document.getElementById('m-login');
    const mLogout    = document.getElementById('m-register');

    // User menu elements
    const userMenu     = document.getElementById('userMenu');
    const userChipBtn  = document.getElementById('userChipBtn');
    const userDropdown = document.getElementById('userDropdown');
    const btnLogoutUser= document.getElementById('btnLogoutUser');
    const chipName     = document.getElementById('chipName');
    const chipAvatar   = document.getElementById('chipAvatar');

    function isAuthed(){
      try{
        const t = localStorage.getItem('ctct_token') || sessionStorage.getItem('ctct_token');
        return !!t && t !== 'null' && t !== 'undefined';
      }catch{return false;}
    }
    function setHidden(el, h){ if(el) el.hidden = !!h; }

    function fillUserChip(){
      try{
        const u = JSON.parse(localStorage.getItem('ctct_user') || '{}');
        const name = (u.name || u.username || 'Ng∆∞·ªùi d√πng').toString();
        chipName.textContent = name;
        chipAvatar.textContent = name.trim().slice(0,1).toUpperCase();
      }catch(e){
        chipName.textContent = 'Ng∆∞·ªùi d√πng';
        chipAvatar.textContent = 'U';
      }
    }

    function updateAuthUI(){
      const on = isAuthed();
      document.body.classList.toggle('authed', on);

      userMenu.hidden = !on;
      if (on) fillUserChip();

      btnLogout?.setAttribute('hidden','');
      if (btnLogin) btnLogin.hidden = on;

      if (mLogin)  mLogin.hidden  = on;
      if (mLogout) mLogout.hidden = !on;

      setHidden(btnLogin,  on);
      setHidden(btnLogout, true);
      setHidden(userMenu, !on);
      if (on) fillUserChip();
      setHidden(mLogin,  on);
      setHidden(mLogout, !on);
    }

    function goLogin(redirectTo){
      const ret = encodeURIComponent(redirectTo || location.href);
      location.href = `login.html?redirect=${ret}`;
    }

    btnLogin?.addEventListener('click', ()=>goLogin());
    mLogin?.addEventListener('click', ()=>goLogin());

    function guardLink(a){
      if(!a) return;
      a.addEventListener('click', (e)=>{
        if (isAuthed()) return;
        e.preventDefault();
        const href = new URL(a.getAttribute('href'), location.href).href;
        goLogin(href);
      });
    }
    ['a[href="kiemtra.html"]','a[href="practice.html"]','a[href="quiz.html"]','a[href="my-results.html"]','a[href="leaderboard.html"]']
      .forEach(sel => document.querySelectorAll(sel).forEach(guardLink));

    function doLogout(){
      try{
        localStorage.removeItem('ctct_token');
        localStorage.removeItem('ctct_user');
        sessionStorage.removeItem('ctct_token');
        localStorage.setItem('ctct_token',''); localStorage.removeItem('ctct_token');
      }catch{}
      updateAuthUI();
      if (userDropdown) userDropdown.hidden = true;
    }
    btnLogout?.addEventListener('click', doLogout);
    mLogout?.addEventListener('click', doLogout);
    btnLogoutUser?.addEventListener('click', doLogout);

    userChipBtn?.addEventListener('click', ()=>{
      if(!isAuthed()) return;
      const isOpen = !userDropdown.hidden;
      userDropdown.hidden = isOpen;
    });

    document.addEventListener('click', (e)=>{
      if (!userMenu.contains(e.target)) {
        userDropdown.hidden = true;
      }
    });

    window.addEventListener('storage', (e)=>{ if(e.key==='ctct_token') updateAuthUI(); });

    updateAuthUI();

    const y = document.getElementById('y');
    if (y) y.textContent = new Date().getFullYear();
  })();
  </script>
</body>
</html>
